# Manufacturing Line Productivity Analysis: Technical Report

## Project Objectives

The primary goal of this analysis was to identify the root causes of production downtime on a key beverage bottling line. The objectives were:

1.  **Data Transformation:** To clean, unpivot, and merge multiple data sources into a single, analysis-ready dataset.
2.  **Root Cause Analysis:** To identify the primary drivers of downtime, focusing on specific reasons, products, operators, and times of day.
3.  **Performance Evaluation:** To analyze operator performance and identify specific challenges and training opportunities.
4.  **Strategic Recommendations:** To provide data-driven recommendations to the plant manager to improve line efficiency, reduce downtime, and increase productivity.

---

## Part 1: ETL - Data Cleaning & Transformation (Power Query)

The initial data was fragmented and required significant transformation to be useful for analysis. The entire ETL process was built in Power Query to create an automated and refreshable data pipeline.

### 1. Unpivoting Downtime Data
* **Challenge:** The `Line downtime` data was in a "wide" format with 12 separate columns for downtime factors, making it impossible to aggregate.
* **Solution:** The **"Unpivot Columns"** feature in Power Query was used to transform these 12 columns into two: "Downtime Factor" and "Downtime (minutes)," creating a "tall" table where each row represents a single downtime event.

### 2. Merging Data Sources
* Multiple **"Merge Queries"** operations were performed to create a single, comprehensive fact table.
    * The unpivoted downtime table was merged with `Downtime factors` to add clear text descriptions for each downtime reason.
    * This enriched table was then merged with the `Line productivity` table on the `Batch` ID to link each downtime event to a specific product and operator.

### 3. Handling Complex Calculations
* **Overnight Shifts:** The initial `End Time` - `Start Time` calculation produced errors for batches that ran past midnight.
    * **Solution:** A custom column was created using a conditional Power Query formula (`if [End Time] < [Start Time] then...`) to correctly calculate the `EndDateTime`. This involved combining `Date` and `Time` components and adding a day to the end date when a shift crossed midnight. This fixed all duration calculations.
* **Efficiency Metric:** A custom `Efficiency` metric was calculated (`Min batch time / Actual Production Time`). This required creating several intermediate custom columns for `Total Batch Duration`, `Total Downtime per Batch`, and `Actual Production Time`. *Note: A data quality issue where batch durations perfectly matched the theoretical minimums was identified, preventing the final use of this metric.*

---

## Part 2: Analysis & Visualization (PivotTables & Charts)

With the data cleaned, PivotTables and PivotCharts were used to analyze the data from multiple dimensions.

### 1. Identifying the "Vital Few" Problems
* A **Pareto Chart** was created to visualize the 80/20 rule. It showed that the top 3 downtime reasons—**Machine Adjustment, Machine Failure, and Inventory Shortage**—were responsible for the vast majority of lost time.

### 2. Pinpointing Problem Products and Operators
* Simple bar charts immediately highlighted the key outliers:
    * **Product:** The **`CO-600`** was identified as the single largest source of downtime.
    * **Operator:** The analysis separated downtime into "Operator Error" and "Systemic Issues" to provide a fair assessment of performance and identify targeted training needs for specific tasks (e.g., Charlie with machine adjustments, Mac with batch changes).

### 3. Analyzing Trends Over Time
* A **Line & Column Combo Chart** was created to show downtime by the hour of the day. An average line was added for context.
* **Insight:** This chart proved that downtime was not random, but clustered around peak production hours (12 PM, 2 PM, 7 PM).

### 4. Creating an Actionable Summary Table
* A dynamic summary table was built using the **`SUMIFS`** function, populated with a dynamic list of the Top 5 downtime reasons generated by the `INDEX`, `SORT`, and `SEQUENCE` functions.
* **Multi-step conditional formatting** was applied to this table to visually distinguish between minor (<60 min), significant (>60 min), and critical (>90 min) downtime events.

---

## Part 3: Strategic Recommendations & Dashboard

The final step was to synthesize all findings into an interactive dashboard and a set of clear recommendations for the plant manager.

### Key Insights
* The primary drivers of downtime are **systemic issues** (machine failures, inventory shortages), not just operator errors.
* The **`CO-600` product** magnifies these systemic problems.
* Operator issues are **specific and predictable**, occurring at certain times with certain tasks.

### Final Recommendations
1.  **Launch a Preventative Maintenance Review:** Focus investigative and maintenance efforts on the equipment used for the `CO-600` line.
2.  **Investigate the Supply Chain:** Address the root cause of **Inventory Shortages**, which appear to be a planning or logistics issue.
3.  **Implement Targeted Operator Training:** Provide focused, time-of-day specific training to operators on the tasks they struggle with most (e.g., Charlie on evening machine adjustments, Mac on pre-lunch batch changes).
